(()=>{"use strict";var e=function(e){return 1.8*e+32},t=function(e,t){return Number.parseInt(e*t)/t};function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t))}var o=new WeakMap,r=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,s=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,v=new WeakMap,m=new WeakMap,p=new WeakMap,w=new WeakMap,y=new WeakMap,g=new WeakMap,b=new WeakMap,k=new WeakMap,S=new WeakMap,L=new WeakMap,C=new WeakMap,E=new WeakMap,M=new WeakMap,W=new WeakMap,q=new WeakMap,x=new WeakMap,P=new WeakMap,O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o.set(this,{writable:!0,value:document.querySelector(".btn-modal")}),r.set(this,{writable:!0,value:document.querySelector(".close")}),c.set(this,{writable:!0,value:document.querySelector(".temp-value")}),l.set(this,{writable:!0,value:document.querySelector(".weather-image")}),u.set(this,{writable:!0,value:document.querySelector(".image")}),s.set(this,{writable:!0,value:document.querySelectorAll(".extra-value")}),d.set(this,{writable:!0,value:document.querySelector(".value")}),h.set(this,{writable:!0,value:document.querySelector(".location")}),f.set(this,{writable:!0,value:document.querySelector(".description")}),v.set(this,{writable:!0,value:document.querySelector(".feels_like")}),m.set(this,{writable:!0,value:document.querySelector(".pressure")}),p.set(this,{writable:!0,value:document.querySelector(".wind_speed")}),w.set(this,{writable:!0,value:document.querySelector(".min_temp")}),y.set(this,{writable:!0,value:document.querySelector(".humidity")}),g.set(this,{writable:!0,value:document.querySelector(".long")}),b.set(this,{writable:!0,value:document.querySelector(".visibility")}),k.set(this,{writable:!0,value:document.querySelector(".lat")}),S.set(this,{writable:!0,value:document.querySelector(".max_temp")}),a(this,"overlay",document.querySelector(".overlay")),a(this,"modal",document.querySelector(".modal")),L.set(this,{writable:!0,value:document.querySelector(".search_input")}),C.set(this,{writable:!0,value:document.querySelector(".btn-submit")}),E.set(this,{writable:!0,value:document.querySelector(".btn-location")}),M.set(this,{writable:!0,value:document.querySelector(".btn-like")}),W.set(this,{writable:!0,value:document.querySelector(".card-container")}),q.set(this,{writable:!0,value:document.querySelector(".btn-save")}),x.set(this,{writable:!0,value:document.querySelector("#search-form")}),P.set(this,{writable:!0,value:document.querySelector(".notification")})}var t,O;return t=e,(O=[{key:"renderOrClearPreview",value:function(){Array.from(i(this,s)).concat(i(this,c),i(this,l)).forEach((function(e){e.classList.toggle("animate")}))}},{key:"render",value:function(e){i(this,u).src="https://openweathermap.org/img/wn/".concat(e.icon,"@2x.png"),i(this,d).textContent=e.temperature,i(this,h).textContent="".concat(e.city,", ").concat(e.country),i(this,f).textContent=e.description,i(this,v).textContent=e.feelsLike,i(this,m).textContent=e.pressure,i(this,p).textContent=e.windSpeed,i(this,w).textContent=e.minTemperature,i(this,y).textContent=e.humidity,i(this,g).textContent=e.coords.lon,i(this,b).textContent=e.visibility,i(this,k).textContent=e.coords.lat,i(this,S).textContent=e.maxTemperature}},{key:"renderCard",value:function(e,t,n){var a=this;e.forEach((function(e){var o=document.createElement("div");o.classList.add("card");var r=document.createElement("h3");r.classList.add("name"),r.textContent=e.name;var c=document.createElement("p");c.classList.add("data"),c.textContent=e.date;var l=document.createElement("span"),u=document.createElement("i");u.classList.add("fa","fa-trash"),u.style.fontSize="24px",l.appendChild(u),o.append(r,c,l),i(a,W).insertAdjacentElement("beforeend",o),r.addEventListener("click",(function(e){t(e.target.textContent)})),l.addEventListener("click",(function(e){var t=e.target.parentElement.parentElement;i(a,W).removeChild(t),n(e.target.parentElement.previousElementSibling.previousElementSibling.textContent)}))}))}},{key:"clearNodes",value:function(){document.querySelectorAll(".card").forEach((function(e){e.remove()}))}},{key:"eventListeners",value:function(e){i(this,o).addEventListener("click",e.openModal),i(this,r).addEventListener("click",e.closeModal),i(this,C).addEventListener("click",e.handleFormSubmit),i(this,x).addEventListener("submit",(function(e){return e.preventDefault()})),i(this,E).addEventListener("click",e.handleLocationButton),i(this,M).addEventListener("click",e.handleLikeButton),i(this,q).addEventListener("click",e.handleButtonSave),window.addEventListener("load",e.handlePageLoad)}},{key:"getFormInput",value:function(){try{return function(e){if(""!==e)return e.replace(" ","");throw new Error("Invalid City Name")}(i(this,L).value)}catch(e){return this.renderNotification(e.message),null}}},{key:"renderNotification",value:function(e){var t=this;i(this,P).textContent=e,i(this,P).classList.toggle("clear"),setTimeout((function(){i(t,P).classList.toggle("clear")}),3e3)}}])&&n(t.prototype,O),e}();function I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function D(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,T(e,t,"set"),n),n}function N(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,T(e,t,"get"))}function T(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function B(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var _,F,j,A=new WeakMap,R=new WeakMap,z=new WeakMap,G=new WeakSet,H=new WeakSet,J=new WeakSet,K=new WeakSet,Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),K.add(this),J.add(this),H.add(this),G.add(this),A.set(this,{writable:!0,value:void 0}),R.set(this,{writable:!0,value:void 0}),z.set(this,{writable:!0,value:void 0})}var t,n;return t=e,(n=[{key:"fetchDataOnPageLoad",value:function(){var e=this,t=B(this,G,U).call(this);return new Promise(t?function(n,a){var i=t[0],o=t[1],r="https://api.openweathermap.org/data/2.5/weather?lat=".concat(i,"&lon=").concat(o,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");B(e,J,X).call(e,r,n,a)}:function(t,n){B(e,H,V).call(e).then((function(a){var i=a[0],o=a[1],r="https://api.openweathermap.org/data/2.5/weather?lat=".concat(i,"&lon=").concat(o,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");B(e,J,X).call(e,r,t,n),e.setDefaultLocationOnPageLoad(a)})).catch((function(e){n(e)}))})}},{key:"fetchDataOnFormSubmit",value:function(e){var t=this;return new Promise((function(n,a){var i="https://api.openweathermap.org/data/2.5/weather?q=".concat(e,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");B(t,J,X).call(t,i,n,a)}))}},{key:"fetchDataOnLocationButton",value:function(){var e=this;return new Promise((function(t,n){B(e,H,V).call(e).then((function(a){var i=a[0],o=a[1],r="https://api.openweathermap.org/data/2.5/weather?lat=".concat(i,"&lon=").concat(o,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");B(e,J,X).call(e,r,t,n)})).catch((function(e){n(e)}))}))}},{key:"setDefaultLocationOnPageLoad",value:function(e){if(!localStorage.getItem("defaultLocation")){var t="".concat(e[0],",").concat(e[1]);localStorage.setItem("defaultLocation",t)}}},{key:"setDefaultLocationOnButtonClick",value:function(){if(!localStorage.getItem("defaultLocation")||!N(this,A))throw new Error("Please reload your browser");var e="".concat(N(this,A).coords.lat,",").concat(N(this,A).coords.lon);localStorage.removeItem("defaultLocation"),localStorage.setItem("defaultLocation",e)}},{key:"persistLocation",value:function(){if(localStorage.getItem("locations")&&N(this,R)){for(var e=localStorage.getItem("locations").split(","),t=0;t<e.length;t+=2)if(e[t]===N(this,R))return null;e.push("".concat(N(this,R),",").concat(Date())),localStorage.setItem("locations",e)}else if(N(this,R)){var n="".concat(N(this,R),",").concat(Date());localStorage.setItem("locations",n)}return N(this,R)}},{key:"retrieveSavedLocation",value:function(){var e=[],t={};if(localStorage.getItem("locations"))for(var n=localStorage.getItem("locations").split(","),a=0;a<n.length;a+=2)t.name=n[a],t.date=n[a+1],e.push(t),t={};return e}},{key:"deleteSavedLocation",value:function(e){var t=[];if(localStorage.getItem("locations"))for(var n=localStorage.getItem("locations").split(","),a=0;a<n.length;a+=2)e!==n[a]&&t.push("".concat(n[a],", ").concat(n[a+1]));localStorage.setItem("locations",t)}}])&&I(t.prototype,n),e}();function U(){return localStorage.getItem("defaultLocation")?window.localStorage.getItem("defaultLocation").split(","):null}function V(){return new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){var n=[];n.push(t.coords.latitude,t.coords.longitude),e(n)}),(function(){t(new Error("Location is needed to continue"))})):t(new Error("Geolocation is not supported"))}))}function X(e,t,n){var a=this;fetch(e).then((function(e){e.ok?e.json().then((function(e){D(a,z,e),B(a,K,Y).call(a),t(N(a,A))})).catch((function(){return n(new Error("Response could not be parsed to json"))})):n(new Error("Invalid Request"))})).catch((function(){return n(new Error("Request could not be made"))}))}function Y(){var n={icon:N(this,z).weather[0].icon,temperature:t(e(N(this,z).main.temp),1),minTemperature:t(e(N(this,z).main.temp_min),100),maxTemperature:t(e(N(this,z).main.temp_max),100),feelsLike:t(e(N(this,z).main.feels_like),100),pressure:N(this,z).main.pressure,humidity:N(this,z).main.humidity,description:N(this,z).weather[0].description,visibility:N(this,z).visibility,windSpeed:N(this,z).wind.speed,country:N(this,z).sys.country,city:N(this,z).name,coords:N(this,z).coord};D(this,A,n),D(this,R,n.city)}_=new O,F=new Q,j={handlePageLoad:function(){_.renderOrClearPreview(),F.fetchDataOnPageLoad().then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e)})).finally((function(){return _.renderOrClearPreview()}))},handleFormSubmit:function(){var e=_.getFormInput();e&&(_.renderOrClearPreview(),F.fetchDataOnFormSubmit(e).then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e.message)})).finally((function(){return _.renderOrClearPreview()})))},handleLocationButton:function(){_.renderOrClearPreview(),F.fetchDataOnLocationButton().then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e.message)})).finally((function(){return _.renderOrClearPreview()}))},handleLikeButton:function(){var e=F.persistLocation();e?_.renderNotification("Location ".concat(e," Saved Successfully!!!")):_.renderNotification("Location Already Exist!!!")},handleButtonSave:function(){try{F.setDefaultLocationOnButtonClick(),_.renderNotification("Location Set As Default!!!")}catch(e){_.renderNotification(e.message)}},handleCard:function(e){var t=this;e&&(_.renderOrClearPreview(),F.fetchDataOnFormSubmit(e).then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e.message)})).finally((function(){t.closeModal(),_.renderOrClearPreview()})))},handleDelete:function(e){F.deleteSavedLocation(e)},openModal:function(){var e=F.retrieveSavedLocation();_.renderCard(e,j.handleCard,j.handleDelete),_.overlay.style.visibility="visible",_.modal.style.visibility="visible"},closeModal:function(){_.clearNodes(),_.overlay.style.visibility="hidden",_.modal.style.visibility="hidden"}},_.eventListeners(j)})();