(()=>{"use strict";var e=function(e){return 1.8*e+32},t=function(e,t){return Number.parseInt(e*t)/t};function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t))}var o=new WeakMap,r=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,s=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,v=new WeakMap,m=new WeakMap,p=new WeakMap,w=new WeakMap,y=new WeakMap,g=new WeakMap,b=new WeakMap,k=new WeakMap,S=new WeakMap,L=new WeakMap,C=new WeakMap,E=new WeakMap,M=new WeakMap,W=new WeakMap,q=new WeakMap,x=new WeakMap,P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o.set(this,{writable:!0,value:document.querySelector(".btn-modal")}),r.set(this,{writable:!0,value:document.querySelector(".close")}),c.set(this,{writable:!0,value:document.querySelector(".temp-value")}),l.set(this,{writable:!0,value:document.querySelector(".weather-image")}),u.set(this,{writable:!0,value:document.querySelector(".image")}),s.set(this,{writable:!0,value:document.querySelectorAll(".extra-value")}),d.set(this,{writable:!0,value:document.querySelector(".value")}),h.set(this,{writable:!0,value:document.querySelector(".location")}),f.set(this,{writable:!0,value:document.querySelector(".description")}),v.set(this,{writable:!0,value:document.querySelector(".feels_like")}),m.set(this,{writable:!0,value:document.querySelector(".pressure")}),p.set(this,{writable:!0,value:document.querySelector(".wind_speed")}),w.set(this,{writable:!0,value:document.querySelector(".min_temp")}),y.set(this,{writable:!0,value:document.querySelector(".humidity")}),g.set(this,{writable:!0,value:document.querySelector(".long")}),b.set(this,{writable:!0,value:document.querySelector(".visibility")}),k.set(this,{writable:!0,value:document.querySelector(".lat")}),S.set(this,{writable:!0,value:document.querySelector(".max_temp")}),L.set(this,{writable:!0,value:document.querySelector(".search_input")}),C.set(this,{writable:!0,value:document.querySelector(".btn-submit")}),E.set(this,{writable:!0,value:document.querySelector(".btn-location")}),M.set(this,{writable:!0,value:document.querySelector(".btn-like")}),W.set(this,{writable:!0,value:document.querySelector(".card-container")}),q.set(this,{writable:!0,value:document.querySelector(".btn-save")}),x.set(this,{writable:!0,value:document.querySelector(".notification")})}var t,a;return t=e,(a=[{key:"renderOrClearPreview",value:function(){Array.from(i(this,s)).concat(i(this,c),i(this,l)).forEach((function(e){e.classList.toggle("animate")}))}},{key:"render",value:function(e){i(this,u).src="https://openweathermap.org/img/wn/".concat(e.icon,"@2x.png"),i(this,d).textContent=e.temperature,i(this,h).textContent="".concat(e.city,", ").concat(e.country),i(this,f).textContent=e.description,i(this,v).textContent=e.feelsLike,i(this,m).textContent=e.pressure,i(this,p).textContent=e.windSpeed,i(this,w).textContent=e.minTemperature,i(this,y).textContent=e.humidity,i(this,g).textContent=e.coords.lon,i(this,b).textContent=e.visibility,i(this,k).textContent=e.coords.lat,i(this,S).textContent=e.maxTemperature}},{key:"renderCard",value:function(e,t,n){var a=this;e.forEach((function(e){var o=document.createElement("div");o.classList.add("card");var r=document.createElement("h3");r.classList.add("name"),r.textContent=e.name;var c=document.createElement("p");c.classList.add("data"),c.textContent=e.date;var l=document.createElement("span"),u=document.createElement("i");u.classList.add("fa","fa-trash"),u.style.fontSize="24px",l.appendChild(u),o.append(r,c,l),i(a,W).insertAdjacentElement("beforeend",o),r.addEventListener("click",(function(e){t(e.target.textContent)})),l.addEventListener("click",(function(e){var t=e.target.parentElement.parentElement;i(a,W).removeChild(t),n(e.target.parentElement.previousElementSibling.previousElementSibling.textContent)}))}))}},{key:"clearNodes",value:function(){document.querySelectorAll(".card").forEach((function(e){e.remove()}))}},{key:"eventListeners",value:function(e){i(this,o).addEventListener("click",e.openModal),i(this,r).addEventListener("click",e.closeModal),i(this,C).addEventListener("click",e.handleFormSubmit),i(this,E).addEventListener("click",e.handleLocationButton),i(this,M).addEventListener("click",e.handleLikeButton),i(this,q).addEventListener("click",e.handleButtonSave),window.addEventListener("load",e.handlePageLoad)}},{key:"getFormInput",value:function(){try{return function(e){if(""!==e)return e.replace(" ","");throw new Error("Invalid City Name")}(i(this,L).value)}catch(e){return this.renderNotification(e.message),null}}},{key:"renderNotification",value:function(e){var t=this;i(this,x).textContent=e,i(this,x).classList.toggle("clear"),setTimeout((function(){i(t,x).classList.toggle("clear")}),3e3)}}])&&n(t.prototype,a),e}();function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,N(e,t,"set"),n),n}function D(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,N(e,t,"get"))}function N(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function T(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}a(P,"overlay",document.querySelector(".overlay")),a(P,"modal",document.querySelector(".modal"));var B,_,F,j=new WeakMap,A=new WeakMap,R=new WeakMap,z=new WeakSet,G=new WeakSet,H=new WeakSet,J=new WeakSet;function K(){return localStorage.getItem("defaultLocation")?window.localStorage.getItem("defaultLocation").split(","):null}function Q(){return new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){var n=[];n.push(t.coords.latitude,t.coords.longitude),e(n)}),(function(){t(new Error("Location is needed to continue"))})):t(new Error("Geolocation is not supported"))}))}function U(e,t,n){var a=this;fetch(e).then((function(e){e.ok?e.json().then((function(e){I(a,R,e),T(a,J,V).call(a),t(D(a,j))})).catch((function(){return n(new Error("Response could not be parsed to json"))})):n(new Error("Invalid Request"))})).catch((function(){return n(new Error("Request could not be made"))}))}function V(){var n={icon:D(this,R).weather[0].icon,temperature:t(e(D(this,R).main.temp),1),minTemperature:t(e(D(this,R).main.temp_min),100),maxTemperature:t(e(D(this,R).main.temp_max),100),feelsLike:t(e(D(this,R).main.feels_like),100),pressure:D(this,R).main.pressure,humidity:D(this,R).main.humidity,description:D(this,R).weather[0].description,visibility:D(this,R).visibility,windSpeed:D(this,R).wind.speed,country:D(this,R).sys.country,city:D(this,R).name,coords:D(this,R).coord};I(this,j,n),I(this,A,n.city)}B=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),J.add(this),H.add(this),G.add(this),z.add(this),j.set(this,{writable:!0,value:void 0}),A.set(this,{writable:!0,value:void 0}),R.set(this,{writable:!0,value:void 0})}var t,n;return t=e,(n=[{key:"fetchDataOnPageLoad",value:function(){var e=this,t=T(this,z,K).call(this);return new Promise(t?function(n,a){var i=t[0],o=t[1],r="https://api.openweathermap.org/data/2.5/weather?lat=".concat(i,"&lon=").concat(o,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");T(e,H,U).call(e,r,n,a)}:function(t,n){T(e,G,Q).call(e).then((function(a){var i=a[0],o=a[1],r="https://api.openweathermap.org/data/2.5/weather?lat=".concat(i,"&lon=").concat(o,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");T(e,H,U).call(e,r,t,n),e.setDefaultLocationOnPageLoad(a)})).catch((function(e){n(e)}))})}},{key:"fetchDataOnFormSubmit",value:function(e){var t=this;return new Promise((function(n,a){var i="https://api.openweathermap.org/data/2.5/weather?q=".concat(e,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");T(t,H,U).call(t,i,n,a)}))}},{key:"fetchDataOnLocationButton",value:function(){var e=this;return new Promise((function(t,n){T(e,G,Q).call(e).then((function(a){var i=a[0],o=a[1],r="https://api.openweathermap.org/data/2.5/weather?lat=".concat(i,"&lon=").concat(o,"&appid=aac304093f797550435d2ed3dad3f25b&units=metric");T(e,H,U).call(e,r,t,n)})).catch((function(e){n(e)}))}))}},{key:"setDefaultLocationOnPageLoad",value:function(e){if(!localStorage.getItem("defaultLocation")){var t="".concat(e[0],",").concat(e[1]);localStorage.setItem("defaultLocation",t)}}},{key:"setDefaultLocationOnButtonClick",value:function(){if(!localStorage.getItem("defaultLocation")||!D(this,j))throw new Error("Please reload your browser");var e="".concat(D(this,j).coords.lat,",").concat(D(this,j).coords.lon);localStorage.removeItem("defaultLocation"),localStorage.setItem("defaultLocation",e)}},{key:"persistLocation",value:function(){if(localStorage.getItem("locations")){for(var e=localStorage.getItem("locations").split(","),t=0;t<e.length;t+=2)if(e[t]===D(this,A))return null;e.push("".concat(D(this,A),",").concat(Date())),localStorage.setItem("locations",e)}else{var n="".concat(D(this,A),",").concat(Date());localStorage.setItem("locations",n)}return D(this,A)}},{key:"retrieveSavedLocation",value:function(){var e=[],t={};if(localStorage.getItem("locations"))for(var n=localStorage.getItem("locations").split(","),a=0;a<n.length;a+=2)t.name=n[a],t.date=n[a+1],e.push(t),t={};return e}},{key:"deleteSavedLocation",value:function(e){var t=[];if(localStorage.getItem("locations"))for(var n=localStorage.getItem("locations").split(","),a=0;a<n.length;a+=2)e!==n[a]&&t.push("".concat(n[a],", ").concat(n[a+1]));localStorage.setItem("locations",t)}}])&&O(t.prototype,n),e}()),_=new P,F={handlePageLoad:function(){_.renderOrClearPreview(),B.fetchDataOnPageLoad().then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e)})).finally((function(){return _.renderOrClearPreview()}))},handleFormSubmit:function(e){e.preventDefault();var t=_.getFormInput();t&&(_.renderOrClearPreview(),B.fetchDataOnFormSubmit(t).then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e.message)})).finally((function(){return _.renderOrClearPreview()})))},handleLocationButton:function(){_.renderOrClearPreview(),B.fetchDataOnLocationButton().then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e.message)})).finally((function(){return _.renderOrClearPreview()}))},handleLikeButton:function(){var e=B.persistLocation();e?_.renderNotification("Location ".concat(e," Saved Successfully!!!")):_.renderNotification("Location Already Exist!!!")},handleButtonSave:function(){try{B.setDefaultLocationOnButtonClick(),_.renderNotification("Location Set As Default!!!")}catch(e){_.renderNotification(e.message)}},handleCard:function(e){e&&(_.renderOrClearPreview(),B.fetchDataOnFormSubmit(e).then((function(e){_.render(e)})).catch((function(e){_.renderNotification(e.message)})).finally((function(){F.closeModal(),_.renderOrClearPreview()})))},handleDelete:function(e){B.deleteSavedLocation(e)},openModal:function(){var e=B.retrieveSavedLocation();_.renderCard(e,F.handleCard,F.handleDelete),P.overlay.style.visibility="visible",P.modal.style.visibility="visible"},closeModal:function(){_.clearNodes(),P.overlay.style.visibility="hidden",P.modal.style.visibility="hidden"}},_.eventListeners(F)})();